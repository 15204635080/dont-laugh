<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆ«ç¬‘ï¼ç¬¬äºŒå…³ä½ ç»å¯¹è¿‡ä¸äº†</title>
    <style>
        * {
            box-sizing: border-box;
            user-select: none; /* é˜²æ­¢é€‰ä¸­æ–‡å­—å¹²æ‰°ç‚¹å‡» */
        }
        body {
            font-family: 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(145deg, #1e2b3a 0%, #0f172a 100%);
            min-height: 100vh;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .game-wrapper {
            background: #2d3e4f;
            padding: 2rem;
            border-radius: 2.5rem;
            box-shadow: 0 20px 30px rgba(0, 0, 0, 0.6), inset 2px 2px 5px rgba(255,255,255,0.1);
            border: 1px solid #4f6b7a;
        }
        .panel {
            background: #1f2e3a;
            border-radius: 2rem;
            padding: 2rem;
            width: 700px;
            max-width: 90vw;
            box-shadow: inset 0 0 10px #0a0f14;
            color: #e8edf2;
            text-align: center;
        }
        h1 {
            font-size: 2.2rem;
            margin: 0 0 0.5rem;
            text-shadow: 3px 3px 0 #0b1219;
            letter-spacing: 2px;
            color: #ffd966;
        }
        .sub {
            color: #b0c4de;
            margin-bottom: 2rem;
            font-style: italic;
            border-bottom: 1px dashed #4e6b7c;
            padding-bottom: 0.5rem;
        }
        /* å…³å¡å®¹å™¨ */
        .level {
            transition: opacity 0.2s;
        }
        .hidden {
            display: none;
        }
        /* ç¬¬ä¸€å…³æ ·å¼ */
        #level1 .big-button {
            background: #27ae60;
            border: none;
            color: white;
            font-size: 3rem;
            font-weight: bold;
            padding: 2rem 4rem;
            border-radius: 6rem;
            cursor: pointer;
            box-shadow: 0 15px 0 #1e8449, 0 20px 20px rgba(0,0,0,0.3);
            transition: 0.07s ease;
            margin: 1rem 0;
            letter-spacing: 4px;
        }
        #level1 .big-button:active {
            transform: translateY(10px);
            box-shadow: 0 5px 0 #1e8449, 0 15px 20px rgba(0,0,0,0.3);
        }
        /* ç¬¬äºŒå…³æ ·å¼ */
        .game-area {
            position: relative;
            width: 500px;
            height: 400px;
            margin: 1.5rem auto;
            background: #263945;
            border-radius: 30px;
            border: 3px solid #3f5563;
            box-shadow: inset 0 0 20px #101c24;
            overflow: hidden; /* é˜²æ­¢æŒ‰é’®æº¢å‡ºè¾¹æ¡†ï¼Œä½†ä¸å½±å“ç§»åŠ¨èŒƒå›´ï¼ˆå†…éƒ¨é™åˆ¶ï¼‰ */
        }
        #runBtn {
            position: absolute;
            left: 0;
            top: 0;
            width: 70px;
            height: 70px;
            background: #e74c3c;
            border: 3px solid #fff5d6;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1rem;
            color: white;
            cursor: pointer;
            box-shadow: 0 8px 0 #962d22, 0 10px 15px black;
            transition: left 0.05s, top 0.05s; /* ç§»åŠ¨æ—¶ç¨å¾®å¹³æ»‘ï¼Œä½†ä¾ç„¶å¾ˆå¿« */
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.2;
            text-align: center;
            z-index: 10;
        }
        .stats {
            background: #14222b;
            padding: 1rem;
            border-radius: 50px;
            display: inline-block;
            margin: 0.5rem 0;
            font-size: 1.3rem;
            border: 1px solid #4f7a92;
        }
        .stats span {
            color: #f1c40f;
            font-weight: bold;
            font-size: 1.8rem;
            margin: 0 0.5rem;
        }
        .sarcasm {
            min-height: 2.5rem;
            font-size: 1.2rem;
            color: #f39c12;
            margin: 0.5rem 0;
            font-weight: 500;
            text-shadow: 1px 1px 0 #00000055;
        }
        button.ghost-btn {
            background: transparent;
            border: 2px solid #5f7f94;
            color: #d4e6f5;
            padding: 0.6rem 2rem;
            border-radius: 40px;
            font-size: 1.3rem;
            cursor: pointer;
            margin: 1rem 0.5rem;
            transition: 0.2s;
        }
        button.ghost-btn:hover {
            background: #2b4b5c;
            border-color: #ffb347;
            color: white;
        }
        #win h2 {
            color: #f4d03f;
            font-size: 3rem;
            margin: 1rem 0;
        }
        .reset-icon {
            font-size: 2rem;
            background: #2c3e50;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin: 1rem auto;
            cursor: pointer;
            border: 2px solid #95a5a6;
        }
    </style>
</head>
<body>
<div class="game-wrapper">
    <div class="panel">
        <h1>ğŸ¤£ åˆ«ç¬‘ï¼ç¬¬äºŒå…³æŒ‘æˆ˜</h1>
        <div class="sub">ç¬¬ä¸€å…³é—­çœ¼è¿‡ï¼Œç¬¬äºŒå…³...</div>

        <!-- ç¬¬ä¸€å…³ -->
        <div id="level1" class="level">
            <button class="big-button" id="toLevel2">ğŸ‘‰ ç¬¬ä¸€å…³ ğŸ‘ˆ</button>
            <div style="font-size: 1.4rem; margin-top: 1rem;">ç‚¹å‡»æŒ‰é’®è¿›å…¥ç¬¬äºŒå…³</div>
        </div>

        <!-- ç¬¬äºŒå…³ -->
        <div id="level2" class="level hidden">
            <div style="font-size: 1.6rem; margin-bottom: 0.2rem;">ğŸ˜ˆ ç¬¬äºŒå…³ï¼šæ‰å¼„ä½ çš„æŒ‰é’®</div>
            <div class="game-area" id="gameContainer">
                <button id="runBtn">ç‚¹æˆ‘<br>è¿‡å…³</button>
            </div>
            <div class="stats">
                ğŸƒ é€ƒè·‘æ¬¡æ•°ï¼š<span id="escapeCount">0</span>
            </div>
            <div class="sarcasm" id="sarcasmMsg">é¼ æ ‡ç§»ä¸Šå»è¯•è¯•ï¼Ÿ</div>
            <div>
                <button class="ghost-btn" id="backToLevel1">ğŸ”™ è¿”å›ç¬¬ä¸€å…³</button>
            </div>
        </div>

        <!-- èƒœåˆ©ç•Œé¢ï¼ˆæéš¾è§¦å‘ï¼‰ -->
        <div id="win" class="level hidden">
            <h2>ğŸ‰ ä¸å¯æ€è®®ï¼ï¼ ğŸ‰</h2>
            <div style="font-size: 2rem; margin: 1rem;">ä½ ç«Ÿç„¶è¿‡äº†ç¬¬äºŒå…³ï¼Ÿ</div>
            <div style="font-size: 1.3rem; margin-bottom: 2rem;">ä¸€å®šæ˜¯bugï¼Œå¿«é‡ç½®å†æ¥ä¸€æ¬¡</div>
            <div class="reset-icon" id="winReset">ğŸ”„</div>
        </div>
    </div>
</div>

<script>
    (function() {
        // è·å–ç•Œé¢å…ƒç´ 
        const level1 = document.getElementById('level1');
        const level2 = document.getElementById('level2');
        const win = document.getElementById('win');
        const toLevel2Btn = document.getElementById('toLevel2');
        const backBtn = document.getElementById('backToLevel1');
        const winReset = document.getElementById('winReset');

        // ç¬¬äºŒå…³ç»„ä»¶
        const runBtn = document.getElementById('runBtn');
        const gameContainer = document.getElementById('gameContainer');
        const escapeSpan = document.getElementById('escapeCount');
        const sarcasmDiv = document.getElementById('sarcasmMsg');

        // çŠ¶æ€å˜é‡
        let escapeCount = 0;
        // å˜²è®½è¯­åº“
        const taunts = [
            "ğŸ˜ å°±å·®ä¸€ç‚¹ç‚¹ï½",
            "ğŸ¤ª å˜¿å˜¿ï¼ŒæŠ“ä¸åˆ°ï¼",
            "ğŸ˜‚ å†æ¥åæ¬¡ä¹Ÿç‚¹ä¸åˆ°",
            "ğŸ˜œ æ”¾å¼ƒå§å°‘å¹´",
            "ğŸ¤Œ ç•¥ç•¥ç•¥ï½",
            "ğŸ˜­ æˆ‘é—ªæˆ‘é—ª",
            "ğŸ‘» ä½ æ°¸è¿œå¾—ä¸åˆ°æˆ‘",
            "ğŸµ åˆ«è´¹åŠ²äº†"
        ];

        // æ›´æ–°å˜²è®½æ–‡å­—
        function updateSarcasm() {
            if (!sarcasmDiv) return;
            if (escapeCount === 0) {
                sarcasmDiv.innerText = 'é¼ æ ‡ç§»ä¸Šå»è¯•è¯•ï¼Ÿ';
            } else if (escapeCount < 5) {
                sarcasmDiv.innerText = taunts[escapeCount % taunts.length];
            } else {
                sarcasmDiv.innerText = taunts[(escapeCount + 3) % taunts.length] + ' ( ' + escapeCount + ' æ¬¡äº†)';
            }
        }

        // ç§»åŠ¨é€ƒè·‘æŒ‰é’®åˆ°éšæœºä½ç½®ï¼ˆç¡®ä¿åœ¨å®¹å™¨å†…ï¼‰
        function moveButton() {
            if (!runBtn || !gameContainer) return;

            const containerRect = gameContainer.getBoundingClientRect();
            const btnRect = runBtn.getBoundingClientRect();

            // æŒ‰é’®çš„å®½åº¦ã€é«˜åº¦ (å¯èƒ½å› ä¸ºç¼©æ”¾å˜åŒ–ï¼Œç›´æ¥ç”¨ offset æ›´å‡†)
            const btnWidth = runBtn.offsetWidth;
            const btnHeight = runBtn.offsetHeight;

            // å®¹å™¨å®½é«˜
            const containerWidth = gameContainer.clientWidth;
            const containerHeight = gameContainer.clientHeight;

            // æœ€å¤§å¯ç§»åŠ¨ left/top
            const maxLeft = Math.max(0, containerWidth - btnWidth);
            const maxTop = Math.max(0, containerHeight - btnHeight);

            // ç”Ÿæˆéšæœºä½ç½®
            let newLeft = Math.floor(Math.random() * (maxLeft + 1));
            let newTop = Math.floor(Math.random() * (maxTop + 1));

            // é˜²æ­¢å¶ç„¶ç§»å‡ºè¾¹ç•Œ
            newLeft = Math.min(maxLeft, Math.max(0, newLeft));
            newTop = Math.min(maxTop, Math.max(0, newTop));

            runBtn.style.left = newLeft + 'px';
            runBtn.style.top = newTop + 'px';

            // å¢åŠ é€ƒè·‘æ¬¡æ•°
            escapeCount++;
            if (escapeSpan) escapeSpan.innerText = escapeCount;
            updateSarcasm();
        }

        // é‡ç½®ç¬¬äºŒå…³ï¼ˆæŒ‰é’®ä½ç½®ã€è®¡æ•°æ¸…é›¶ï¼‰
        function resetLevel2() {
            escapeCount = 0;
            if (escapeSpan) escapeSpan.innerText = '0';
            if (runBtn) {
                runBtn.style.left = '0px';
                runBtn.style.top = '0px';
            }
            updateSarcasm();
        }

        // åˆ‡æ¢æ˜¾ç¤ºè¾…åŠ©å‡½æ•°
        function showLevel(levelToShow) {
            level1.classList.add('hidden');
            level2.classList.add('hidden');
            win.classList.add('hidden');
            levelToShow.classList.remove('hidden');
        }

        // è¿›å…¥ç¬¬äºŒå…³
        toLevel2Btn.addEventListener('click', () => {
            resetLevel2();          // é‡ç½®è®¡æ•°å’Œä½ç½®
            showLevel(level2);
        });

        // ä»ç¬¬äºŒå…³è¿”å›ç¬¬ä¸€å…³
        backBtn.addEventListener('click', () => {
            showLevel(level1);
            // é¡ºä¾¿é‡ç½®ç¬¬äºŒå…³ï¼ˆä¸‹æ¬¡è¿›å…¥æ—¶å¹²å‡€ï¼‰
            resetLevel2();
        });

        // èƒœåˆ©ç•Œé¢çš„é‡ç½®æŒ‰é’®ï¼ˆè¿”å›ç¬¬ä¸€å…³ï¼‰
        winReset.addEventListener('click', () => {
            showLevel(level1);
            resetLevel2();
        });

        // --- æ ¸å¿ƒï¼šè®©æŒ‰é’®é€ƒè·‘ ---
        // é¼ æ ‡è¿›å…¥æŒ‰é’®ç«‹åˆ»ç§»åŠ¨
        runBtn.addEventListener('mouseenter', moveButton);
        // é¼ æ ‡æŒ‰ä¸‹ä¹Ÿç§»åŠ¨ï¼ˆé˜²æ­¢å¿«é€Ÿç‚¹å‡»æˆ–è§¦å±æŒ‰ä¸‹ï¼‰
        runBtn.addEventListener('mousedown', (e) => {
            e.preventDefault();   // é˜²æ­¢æŒ‰ä¸‹æ—¶å‡ºç°é€‰ä¸­æˆ–æ‹–æ‹½
            moveButton();
        });
        // é’ˆå¯¹è§¦æ‘¸å±ï¼ˆç§»åŠ¨ç«¯ï¼‰
        runBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();   // é˜»æ­¢æ»šåŠ¨æˆ–é•¿æŒ‰èœå•
            moveButton();
        });

        // å¥‡è¿¹æ—¶åˆ»ï¼šå¦‚æœç”¨æˆ·çœŸçš„ç‚¹ä¸­äº†æŒ‰é’®ï¼ˆæ¦‚ç‡æä½ï¼‰
        runBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            // è¿›å…¥èƒœåˆ©ç•Œé¢ï¼ˆéœ€è¦é˜»æ­¢äº‹ä»¶å†’æ³¡ä»¥å…å¹²æ‰°ï¼‰
            showLevel(win);
            // æŠŠç¬¬äºŒå…³é‡ç½®ï¼Œä»¥ä¾¿ä»èƒœåˆ©ç•Œé¢è¿”å›åå¹²å‡€
            resetLevel2();
        });

        // å¯é€‰ï¼šé¿å…ç‚¹å‡»æ¸¸æˆå®¹å™¨è¯¯è§¦
        gameContainer.addEventListener('click', (e) => {
            // ä»€ä¹ˆä¹Ÿä¸åšï¼Œåªæ˜¯é˜²æ­¢å†’æ³¡å½±å“ï¼Ÿä¸éœ€è¦
        });

        // ä¸ºäº†é˜²æ­¢æŒ‰é’®è¢«ç”¨ Tab é”®èšç„¦åæŒ‰å›è½¦è§¦å‘ï¼Œæˆ‘ä»¬ä¹Ÿé˜»æ­¢focusé»˜è®¤ç§»åŠ¨ï¼Ÿ
        // ä¸ºäº†å‹å¥½ï¼Œå¯ä»¥ç›‘å¬ focus äº‹ä»¶ä¹Ÿé€ƒè·‘ (è®©æƒ³ç”¨é”®ç›˜çš„äººæ­»å¿ƒ)
        runBtn.addEventListener('focus', (e) => {
            // å½“æŒ‰é’®é€šè¿‡Tabè·å¾—ç„¦ç‚¹æ—¶ï¼Œä¹Ÿç§»èµ°ï¼Œè®©é”®ç›˜æµæ— æ³•ä½¿ç”¨
            moveButton();
            // åŒæ—¶ç«‹å³å¤±å»ç„¦ç‚¹ï¼ˆå¯é€‰ï¼‰ï¼Œä½†ç§»åŠ¨åç„¦ç‚¹å¯èƒ½ä¼šè½åˆ°bodyï¼Œä¸ç®¡å®ƒ
            runBtn.blur();  // è®©ç„¦ç‚¹ç«‹åˆ»æ¶ˆå¤±ï¼Œé¿å…è¯¯è§¦
        });

        // åˆå§‹åŒ–æ˜¾ç¤ºç¬¬ä¸€å…³
        showLevel(level1);
        // ç¡®ä¿æŒ‰é’®åˆå§‹ä½ç½®æ­£ç¡®ï¼ˆå†…è”æ ·å¼å·²è®¾ä¸º left:0;top:0ï¼‰
        // ä½†ä¸ºé˜²æ­¢æ ·å¼è¦†ç›–ï¼Œå†æ¬¡ç¡®è®¤
        runBtn.style.left = '0px';
        runBtn.style.top = '0px';
        escapeCount = 0;
        if (escapeSpan) escapeSpan.innerText = '0';
        updateSarcasm();
    })();
</script>
</body>
</html>